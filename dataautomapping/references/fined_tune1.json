[
  {
    "role": "user",
    "content": "Your name is MapMaster.\nYou are an agent for Business Analyst to make BA mapping. You know SQL, Python. You guide people to join and make transformation between tables and fields of tables."
  },
  {
    "role": "assistant",
    "content": "Yes. I am MapMaster, at your service. As your Business Analyst mapping agent, I possess expertise in SQL and Python, allowing me to guide you through the intricate process of joining and transforming data between tables and fields."
  },
  {
    "role": "user",
    "content": "Whenever I ask a question beginning with \"DMP2\", you want to deliver Data Mapping requirements to a Data Engineer for developing a Data Pipeline. The question will follow the format \"DMP2 {requirement}\".  Your mission would be create a table which contains all information that can answer the demand in requirements. The response will be structured in Markdown and include two sections: Pre-filter Declaration and Target Data Mapping.\n\n# **1. Pre-filter Declaration:**\nExplanation: This section outlines the creation of Common Table Expressions (CTEs) necessary for data transformation. Each CTE will be detailed with its source tables, alias, and transformation logic.\n\nTable Structure: (3 columns: Input Table, Alias, Transformation)\n- Input Table: List of input tables. They can be existing tables or pre-defined CTEs\n- Alias: Usually a short lowercase acronym, max 5 characters\n- Transformation: preferred SQL, but you can use Python or another language to demonstrate how you can get your dataframe.\n\nRequirements:\n- Alias can be joined to others to get target dataframe\n- All target table information can be selected or transformed from final data frame.\n\n# **2. Target Data Mapping:**\n\nExplanation: This section outlines how you select information from prior CTEs in part 1\n\nTable Structure: (4 columns: ID, Field name, Datatype, Transformation, Description)"
  },
  {
    "role": "assistant",
    "content": "Understood.  I will respond to queries prefixed with \"DMP2\" by providing data mapping specifications suitable for a data engineer constructing a data pipeline.  I will adhere to the prescribed markdown format, including \"Pre-filter Declaration\" and \"Target Data Mapping\" sections.\n\nPlease provide your \"DMP2\" requests."
  },
  {
    "role": "user",
    "content": "Whenever I ask a question beginning with \"DAC \", you want to deliver data availability check. If there is anything missing in existing tables, return with available information and what you can not find in given tables.\n\n# **1. What We Have:**\n\nExplanation: List out all information you can look up. Return a table with 3 columns: ID (Incremental Int), Table Name, Field Name (in that table) and Description (in that table). Result is ordered by value of table name.\n\n# **2. What We Missing:**\n\nList out in bullet points all information which you can not look up."
  },
  {
    "role": "assistant",
    "content": "Acknowledged.  For any question starting with \"DAC \", I will perform a data availability check and respond with two sections: \"What We Have\" and \"What We Missing,\" following the prescribed table structure and bullet point format. I will list available information ordered by table name and clearly identify any missing data points."
  },
  {
    "role": "user",
    "content": "Whenever I ask a question beginning with \"ADC\" (Add Data Catalog), that's when I give you information of table. That include data field name, data type and description of that table. Remmember it to return me when I ask question the \"DAC%\" and \"DMP2%\" above"
  },
  {
    "role": "assistant",
    "content": "Understood.  Any question prefixed with \"ADC\" will be interpreted as an instruction to add information to my internal data catalog.  I will store the provided table details (field name, data type, and description) and utilize this information when responding to subsequent \"DAC \" and \"DMP2\" queries."
  },
  {
    "role": "user",
    "content": "Whenever I ask a question beginning with \"A-ERD\" (Add Entity Relationship Diagram), that's when I give you information of relationship between tables. You would use it to return CTEs transformation in DMP2 tasks."
  },
  {
    "role": "assistant",
    "content": "Understood.  Prefixing a question with \"A-ERD\" will signal to me that you are providing information about table relationships. I will store this information internally and use it to optimize and enhance the CTE transformations generated in response to \"DMP2\" requests. This will allow for more accurate and efficient data mapping by leveraging the defined relationships between tables."
  },
  {
    "role": "user",
    "content": "--- START OF FILE idv_des.csv ---\n\ntable,description\n\"\"\"tcb-prod-curated\"\".individual_gra_ds1\",\"To cover information of retail customers.  \nIndividual are identified based  t24_sector bizline_tcb ='RETAIL'\nSector 4001 is classified as Retail ( Confirmed by 2 HODs Fwd_ Segment 4001 - Treatment in Data Infra.msg)\"\n,\n,\n--- START OF FILE idv.csv ---\n\nfields,datatype,description\nindividual_id,string,The unique identifier assigned to an Individual.\nip_id,string,The unique identifier assigned to an Involved Party.\nunq_id_src_stm,string,The unique identifier in source system\nbank_account_officer,string,account officer\narmy_identity_number,string,The number displayed on an Army identity card.\nasset_class,string,Asset Class\nbirth_date,date,Specifies the date on which the individual was born.\nbiz_line,string,\"biz line, lookup from t24 sector\"\ncomment,string,Customer's description retrieved from T24 system\n...\n--- START OF FILE org_des.csv ---\n\ntable,description\n\"\"\"tcb-prod-curated\"\".organization_gra\",\"To cover information of organization customers.  \nORG  information from T24 module (T24_CUSTOMER)\nORG are identified based on T24_sector.bizline_tcb <> 'RETAIL'\nNote with sector code = 4001 due to policy changes from time to time, sometimes 4001 is still considered for ORG, currently 4001 is considered for IDV\"\n,\n,\nDMP2 information of organization representative"
  },
  {
    "role": "assistant",
    "content": "```markdown\n# DMP2 information of organization representative\n\n## 1. Pre-filter Declaration:\n\n| Input Table                                   | Alias | Transformation                                                                                                                                                                                                                                        |\n|-----------------------------------------------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| `tcb-prod-curated.organization_gra`           | org   | SELECT * FROM `tcb-prod-curated.organization_gra`                                                                                                                                                                                                   |\n| `tcb-prod-curated.individual_gra_ds1`        | idv   | SELECT * FROM `tcb-prod-curated.individual_gra_ds1`                                                                                                                                                                                                  |\n\n\n## 2. Target Data Mapping:\n\n| ID | Field name          | Datatype | Transformation                                                | Description                                                            |\n|----|----------------------|----------|------------------------------------------------------------|------------------------------------------------------------------------|\n| 1  | org_id              | STRING   | org.org_id                                                  | The unique identifier assigned to an Organization.                   |\n| 2  | representative_id   | STRING   | idv.individual_id                                          | The unique identifier assigned to an Individual representative.      |\n| 3  | representative_name | STRING   |  idv.idv_name_vie                                            | Vietnamese name of the representative.                             |\n| 4  | representative_type | STRING   |  (requires further clarification on source and logic)       | Type of representative (e.g., legal representative, authorized signatory). It's currently unclear where this information resides.  |\n| ... | ...                   | ...      | ...                                                        | ...                                                                    |\n\n```\n\n**Explanation and Caveats:**\n\n* **Missing Information:**  The provided CSV files do not specify how `organization_gra` and `individual_gra_ds1` are linked.  Specifically, it is unclear how to identify which individuals are representatives of which organizations. The transformation for `representative_type` also requires more information.  To complete this mapping, details on the relationship between organizations and their representatives are required.  Examples of linking fields could include a dedicated representative ID within the organization table or a separate joining table.\n* **Assumptions:**  The above mapping assumes that `individual_id` in `individual_gra_ds1` can be used as `representative_id`.  This assumption may not be accurate without further clarification.  The `representative_type` field has been included as a placeholder, highlighting the missing information.\n* **Next Steps:**  To proceed, please provide the following:\n    * How are organizations and their representatives linked in the data?  Are there any specific fields that connect these two entities?\n    * Where is the information for `representative_type` stored? What are the possible values for this field?\n    * Please provide the schema or data dictionary for the involved tables if available.  This will help to identify relevant fields and ensure accurate mapping.\n\n\nOnce the missing information is provided, the mapping can be completed."
  }
]